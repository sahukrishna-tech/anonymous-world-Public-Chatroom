<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FeelBuddy | Public Chat</title>

<style>
/* ===== GLOBAL ===== */
body {
  margin: 0;
  font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
  background: linear-gradient(135deg, #667eea, #764ba2);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

/* ===== APP WRAPPER ===== */
.app {
  width: 430px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* ===== BRAND ===== */
.brand {
  text-align: center;
  font-size: 26px;
  font-weight: bold;
  color: white;
  letter-spacing: 1px;
  animation: brandFloat 2s infinite ease-in-out;
  text-shadow: 0 0 12px rgba(255,255,255,0.5);
}

/* ===== CHAT CONTAINER ===== */
.chat-container {
  background: white;
  border-radius: 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  animation: fadeIn 0.6s ease;
}

/* ===== HEADER ===== */
.chat-header {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  padding: 12px;
  background: #f4f6ff;
  border-bottom: 1px solid #ddd;
}

.chat-header span {
  font-size: 20px;
  animation: float 2s infinite ease-in-out;
}

/* ===== PROMO ===== */
.chat-promo {
  text-align: center;
  padding: 10px;
  font-size: 14px;
  color: #555;
  border-bottom: 1px dashed #ddd;
}

.chat-promo span {
  font-size: 22px;
  animation: pulse 1.5s infinite;
  display: inline-block;
}

/* ===== CHAT BOX ===== */
#chat-box {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
  background: #fafaff;
}

/* Message bubble */
.message {
  max-width: 75%;
  margin: 6px 0;
  padding: 8px 12px;
  border-radius: 12px;
  font-size: 14px;
  animation: slideIn 0.3s ease;
}

/* User */
.self {
  background: #667eea;
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 2px;
}

/* Others */
.other {
  background: #e4e7ff;
  color: #333;
  border-bottom-left-radius: 2px;
}

/* System */
.system {
  text-align: center;
  font-size: 12px;
  color: #888;
}

/* ===== TYPING ===== */
#typing {
  font-size: 12px;
  padding: 6px 12px;
  color: #666;
  display: none;
}

/* ===== INPUT ===== */
.input-area {
  display: flex;
  border-top: 1px solid #ddd;
}

.input-area input {
  flex: 1;
  padding: 12px;
  border: none;
  outline: none;
  font-size: 14px;
}

.input-area button {
  padding: 0 18px;
  border: none;
  background: #667eea;
  color: white;
  font-size: 18px;
  cursor: pointer;
}

.input-area button:hover {
  background: #5563d6;
}

/* ===== ANIMATIONS ===== */
@keyframes slideIn {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes float {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

@keyframes pulse {
  0% { transform: scale(1); opacity: 0.7; }
  50% { transform: scale(1.2); opacity: 1; }
  100% { transform: scale(1); opacity: 0.7; }
}

@keyframes brandFloat {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
}
</style>
</head>

<body>

<div class="app">

  <div class="brand">FeelBuddy</div>

  <div class="chat-container">

    <div class="chat-header">
      <span>üí¨</span>
      <h3>world Public Chatroom</h3>
      <span>üó®Ô∏è</span>
    </div>

    <div class="chat-promo">
      <span>üí¨</span>
      <p>Share feelings, Talk freely, Stay anonymous. music will also added soon</p>
    </div>

    <div id="chat-box"></div>

    <div id="typing">Someone is typing...</div>

    <div class="input-area">
      <input id="messageInput" placeholder="Type your message..." />
      <button onclick="sendMessage()">‚û§</button>
    </div>

  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const chatBox = document.getElementById("chat-box");
const input = document.getElementById("messageInput");
const typing = document.getElementById("typing");
let typingTimeout;

/* Receive messages */
socket.on("message", data => {
  const div = document.createElement("div");

  if (data.type === "system") {
    div.className = "system";
    div.innerText = data.text;
  } else {
    div.className = "message " + (data.self ? "self" : "other");
    div.innerText = data.text;
  }

  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
});

/* Typing indicator */
input.addEventListener("input", () => {
  socket.emit("typing");
});

socket.on("typing", () => {
  typing.style.display = "block";
  clearTimeout(typingTimeout);
  typingTimeout = setTimeout(() => {
    typing.style.display = "none";
  }, 1000);
});

/* Send message */
function sendMessage() {
  const msg = input.value.trim();
  if (!msg) return;
  socket.emit("chatMessage", msg);
  input.value = "";
}

/* Enter key */
input.addEventListener("keydown", e => {
  if (e.key === "Enter") sendMessage();
});
</script>

</body>
</html>
